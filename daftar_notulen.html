<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Notulen Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body { 
      background-color: #f5f7fa; 
      margin: 0; 
      padding: 0; 
    }
    .navbar { 
      background-color: 
      #1a237e; 
    }
    .navbar-brand { 
      color: white; 
      font-weight: 600; 
    }
    .navbar-nav .nav-link { 
      color: #cfd8dc !important; 
      margin-right: 15px; 
    }
    .navbar-nav .nav-link.active { 
      color: #fff !important; 
      font-weight: 600; 
    }
    .btn-logout { 
      background-color: #0d47a1; 
      color: white; 
      border-radius: 6px; 
      font-weight: 500; 
    }
    .btn-logout:hover { 
      background-color: #1565c0; 
    }
    .card { 
      border-radius: 10px; 
    }
    .table thead th { 
      background-color: #1a237e; 
      color: white; 
      text-align: center; 
      font-weight: 600; 
    }
    .status-draft { 
      background-color: #fbc02d; 
      color: #000; 
      padding: 4px 10px; 
      border-radius: 5px; 
      font-size: 0.85rem; 
    }
    .status-final { 
      background-color: #2e7d32; 
      color: white; 
      padding: 4px 10px; 
      border-radius: 5px; 
      font-size: 0.85rem; 
    }
    .btn-lihat { 
      background-color: #1565c0; 
      color: white; 
    }
    .btn-edit { 
      background-color: #2e7d32; 
      color: white; 
    }
    .btn-tambah-arsip { 
      background-color: #1a237e; 
      color: white; 
      font-weight: 500; 
      border-radius: 6px; 
      border: none; 
      padding: 8px 16px; 
    }
    .btn-tambah-arsip:hover { 
      background-color: #303f9f;
    }
    .full-container { 
      width: 100%; 
      padding: 0 30px; 
    }
    .table tbody tr:hover { 
      background-color: #f1f3f6; 
    }
    .modal-header { 
      background-color: #1a237e; 
      color: white; 
    }
    .detail-label { 
      font-weight: 600; 
      color: #1a237e; 
    }
    .table-hasil th, .table-hasil td { 
      vertical-align: middle; 
      text-align: center; 
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark px-4">
    <a class="navbar-brand" href="#">Notulen Tracker</a>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link active" href="#">Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Agenda</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Notulen</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Arsip</a></li>
        <li class="nav-item"><a class="nav-link" href="#">FAQ</a></li>
      </ul>
    </div>
    <button class="btn btn-logout ms-3">Logout</button>
  </nav>

  <!-- Konten -->
  <div class="full-container mt-4">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="text-primary fw-bold mb-0">ðŸ“˜ DAFTAR NOTULEN RAPAT</h5>
          <div class="d-flex gap-2">
            <button class="btn btn-outline-primary btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#filterPanel">
              <i class="bi bi-funnel"></i> Filter
            </button>
            <button class="btn-tambah-arsip">+ Tambah Notulen</button>
          </div>
        </div>

        <!-- Panel Filter -->
        <div class="collapse mb-3" id="filterPanel">
          <div class="card card-body">
            <form id="filterForm" class="row g-2">
              <div class="col-md-4"><input type="text" id="filterJudul" class="form-control" placeholder="Cari judul..."></div>
              <div class="col-md-3"><input type="date" id="filterTanggal" class="form-control"></div>
              <div class="col-md-3"><input type="text" id="filterPIC" class="form-control" placeholder="Cari PIC..."></div>
              <div class="col-md-2">
                <select id="filterStatus" class="form-select">
                  <option value="All" selected>All</option>
                  <option value="Draft">Draft</option>
                  <option value="Final">Final</option>
                </select>
              </div>
              <div class="col-12 text-end">
                <button type="submit" class="btn btn-primary btn-sm"><i class="bi bi-search"></i> Terapkan Filter</button>
                <button type="button" id="resetFilter" class="btn btn-secondary btn-sm ms-1"><i class="bi bi-arrow-repeat"></i> Reset</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Tabel -->
        <div class="table-responsive">
          <table class="table table-bordered align-middle" id="notulenTable">
            <thead>
              <tr>
                <th>Judul Rapat</th>
                <th>Tanggal</th>
                <th>PIC</th>
                <th>Status</th>
                <th>Aksi</th>
              </tr>
            </thead>
            <tbody>
              <tr data-detail='{"judul":"Evaluasi Kinerja Tim Bulanan - September 2025","tanggal":"2025-09-30","waktu":"08:00 - 11:00 WIB","tempat":"Ruang Diversity lantai 3","penyelenggara":"Divisi HRD","notulis":"Umiarti Ningsih","peserta":["Nafillah Thahirah Anwar","Robbi Akraman","Lolly Carolina B Nababan"],"agenda":["Evaluasi kehadiran dan produktivitas bulan September","Pembahasan target bulan Oktober","Rencana pelatihan peningkatan kompetensi"],"pembahasan":[["Evaluasi Kehadiran","Tingkat kehadiran meningkat 10%","Melakukan sistem absensi online","HRD"],["Target Oktober","Fokus peningkatan efisiensi kerja","Buat laporan efisiensi mingguan","Semua kepala divisi"],["Pelatihan Karyawan","Rencana pelatihan soft skill 20 Okt 2025","HRD mengatur vendor pelatihan","HRD"]],"catatan":["Meninjau kembali sistem reward karyawan berprestasi","Rapat berikutnya 12 Oktober 2025 pukul 09.00 WIB"],"status":"Draft"}'>
                <td>Rapat Evaluasi Bulanan</td>
                <td>2025-09-30</td>
                <td>Umiarti Ningsih</td>
                <td class="text-center"><span class="status-draft">Draft</span></td>
                <td class="text-center">
                  <button class="btn btn-lihat btn-sm">Lihat</button>
                  <button class="btn btn-edit btn-sm">Edit</button>
                </td>
              </tr>
              <tr>
                <td>Koordinasi Proyek B</td>
                <td>2025-09-25</td>
                <td>Robbi Akraman</td>
                <td class="text-center"><span class="status-final">Final</span></td>
                <td class="text-center">
                  <button class="btn btn-lihat btn-sm">Lihat</button>
                  <button class="btn btn-edit btn-sm">Edit</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

      </div>
    </div>
  </div>

  <!-- Modal Detail -->
  <div class="modal fade" id="detailModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content shadow-lg">
        <div class="modal-header">
          <h5 class="modal-title fw-semibold">Hasil Rapat</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="detailContent"></div>
      </div>
    </div>
  </div>

  <!-- Modal Edit -->
  <div class="modal fade" id="editModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">Edit Notulen Rapat</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="editForm">
            <div class="mb-3"><label class="form-label">Judul Rapat</label><input type="text" class="form-control" id="editJudul"></div>
            <div class="mb-3"><label class="form-label">Tanggal Rapat</label><input type="date" class="form-control" id="editTanggal"></div>
            <div class="mb-3"><label class="form-label">Notulis</label><input type="text" class="form-control" id="editNotulis"></div>
            <div class="mb-3"><label class="form-label">Status</label>
              <select class="form-select" id="editStatus">
                <option>Draft</option>
                <option>Final</option>
                <option>Belum Selesai</option>
                <option>Selesai</option>
              </select>
            </div>
            <button type="submit" class="btn btn-success">Simpan Perubahan</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Script -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Filter data
    const form = document.getElementById("filterForm");
    const resetBtn = document.getElementById("resetFilter");
    const table = document.getElementById("notulenTable").getElementsByTagName("tbody")[0];
    form.addEventListener("submit", e => {
      e.preventDefault();
      const judul = document.getElementById("filterJudul").value.toLowerCase();
      const tanggal = document.getElementById("filterTanggal").value;
      const pic = document.getElementById("filterPIC").value.toLowerCase();
      const status = document.getElementById("filterStatus").value;
      for (let row of table.rows) {
        const judulText = row.cells[0].textContent.toLowerCase();
        const tanggalText = row.cells[1].textContent.trim();
        const picText = row.cells[2].textContent.toLowerCase();
        const statusText = row.cells[3].textContent.trim();
        let visible = true;
        if (judul && !judulText.includes(judul)) visible = false;
        if (tanggal && tanggalText !== tanggal) visible = false;
        if (pic && !picText.includes(pic)) visible = false;
        if (status !== "All" && !statusText.includes(status)) visible = false;
        row.style.display = visible ? "" : "none";
      }
    });
    resetBtn.addEventListener("click", () => {
      form.reset();
      for (let row of table.rows) row.style.display = "";
    });

    // Detail rapat
    document.querySelectorAll(".btn-lihat").forEach(btn => {
      btn.addEventListener("click", e => {
        const data = JSON.parse(e.target.closest("tr").dataset.detail || '{}');
        if (!data.judul) return alert("Tidak ada detail untuk baris ini.");
        const content = `
          <div id="rapatDetail">
            <h4 class="text-center fw-bold mb-3">HASIL RAPAT</h4>
            <p><span class="detail-label">Judul Rapat:</span> ${data.judul}</p>
            <p><span class="detail-label">Tanggal Rapat:</span> ${data.tanggal}</p>
            <p><span class="detail-label">Waktu:</span> ${data.waktu}</p>
            <p><span class="detail-label">Tempat:</span> ${data.tempat}</p>
            <p><span class="detail-label">Penyelenggara:</span> ${data.penyelenggara}</p>
            <p><span class="detail-label">Notulis:</span> ${data.notulis}</p>
            <p><span class="detail-label">Peserta:</span><br>${data.peserta.map(p=>"- "+p).join("<br>")}</p>
            <hr>
            <h6 class="text-primary fw-bold">Agenda Rapat:</h6>
            <ol>${data.agenda.map(a=>`<li>${a}</li>`).join("")}</ol>
            <h6 class="text-primary fw-bold mt-3">Hasil Pembahasan:</h6>
            <table class="table table-bordered table-hasil">
              <thead><tr><th>No</th><th>Topik</th><th>Pembahasan</th><th>Tindak Lanjut</th><th>PJ</th></tr></thead>
              <tbody>${data.pembahasan.map((p,i)=>`<tr><td>${i+1}</td><td>${p[0]}</td><td>${p[1]}</td><td>${p[2]}</td><td>${p[3]}</td></tr>`).join("")}</tbody>
            </table>
            <h6 class="text-primary fw-bold">Catatan Tambahan:</h6>
            <ul>${data.catatan.map(c=>`<li>${c}</li>`).join("")}</ul>
            <p class="mt-3"><span class="detail-label">Status Rapat:</span> ${data.status}</p>
          </div>
          <div class="text-end mt-4">
            <button class="btn btn-success me-2" id="btnEdit"><i class="bi bi-pencil-square"></i> Edit</button>
            <button class="btn btn-secondary me-2" id="btnShare"><i class="bi bi-share"></i> Bagikan</button>
            <button class="btn btn-dark" id="btnDownload"><i class="bi bi-file-earmark-pdf"></i> Download PDF</button>
          </div>`;
        document.getElementById("detailContent").innerHTML = content;
        new bootstrap.Modal(document.getElementById("detailModal")).show();

        document.getElementById("btnDownload").addEventListener("click", () => {
          html2pdf().from(document.getElementById("rapatDetail")).set({
            margin: 0.5,
            filename: `${data.judul.replace(/\s+/g,'_')}.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
          }).save();
        });
        document.getElementById("btnShare").addEventListener("click", () => {
          navigator.clipboard.writeText(`https://notulen-tracker.example.com/rapat/${encodeURIComponent(data.judul)}`);
          alert("ðŸ”— Link hasil rapat berhasil disalin!");
        });
        document.getElementById("btnEdit").addEventListener("click", () => {
          document.getElementById("editJudul").value = data.judul;
          document.getElementById("editTanggal").value = data.tanggal;
          document.getElementById("editNotulis").value = data.notulis;
          document.getElementById("editStatus").value = data.status;
          new bootstrap.Modal(document.getElementById("editModal")).show();
        });
      });
    });

    document.getElementById("editForm").addEventListener("submit", e => {
      e.preventDefault();
      alert("âœ… Perubahan notulen berhasil disimpan!");
      bootstrap.Modal.getInstance(document.getElementById("editModal")).hide();
    });
  </script>
</body>
</html>
